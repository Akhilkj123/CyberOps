## Part 1: Investigate the Attack with Sguil
### Step 1: Open Sguil and locate the alerts on 3-19-2019.
a. Login to Security Onion VM with the analyst username and cyberops password.

b. Launch Sguil from the desktop. Login with username analyst and password cyberops. Click Select All
and Start Sguil to view all the alerts generated by the network sensors.

c. Locate the group of alerts from 19 March 2019.

According to Sguil, what are the timestamps for the first and last of the alerts that occurred on 3-19-2019?
What is interesting about the timestamps of all the alerts on 3-19-2019?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/45a8c858-8319-4403-ab13-22028b626063)
- 01:45:03 to 04:54:34. The alerts show suspicious activity for a little over 3 hours but the majority of the alerts took place for a little over 3 minutes and 43 seconds.

### Step 2: Review the alerts in detail.
a. In Sguil, click the first of the alerts on 3-19-2019 (Alert ID 5.439). Make sure to check the Show Packet
Data and Show Rule checkboxes to examine the packet header information and the IDS signature rule related to the alert. Right on the Alert ID and pivot to Wireshark. Based on the information derived from this initial alert answer the following questions:

What was the source IP address and port number and destination IP address and port number?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/ef9d709f-86c4-4af6-96f1-442d457ed008)
- Source Port: 52609 and Destination Port: 53

What type of protocol and request or response was involved?
- UDP, Dynamic DNS

What is the IDS alert and message?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/672411ce-59eb-4488-9b1b-8b4a92de8adb)

Do you think this alert was the result of an IDS misconfiguration or a legitimate suspicious
communication?
- This alert may be the result of a misconfiguration in the IDS because the DNS request was a Dynamic DNS update from an internal host to a DNS server on the internal network

What is the hostname, domain name, and IP address of the source host in the DNS update?
- Bobby-Tiger-PC, littletigers.info, 10.0.90.215

b. In Sguil, select the second of the alerts on 3-19-2019. Right click the Alert ID 5.440 and select
Transcript.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/3cbe50eb-6b3e-41d4-94ce-17935ea6bea6)

From the transcript answer the following questions:

What is the source and destination IP address and port numbers?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/d828c149-dd0a-4c05-8b74-91380007616d)

Looking at the request (blue) what was the request for? 
- GET /test1.exe

Looking at the reply (red) many files will reveal their file signature in the initial few characters of the file
when viewed as text. File signatures help identify the type of file that is represented. Use a web browser
to search for a list of common file signatures.


What is the initial few characters of the file file. Search for this file signature to find out what type of file
was downloaded in the data?
- The initial characters of this fiel is MZ, a Windows executable .exe or .dll file

c. Close the transcript. Use Wireshark to export the executable file for malware analysis (File > Export
Objects > HTTP…). Save the file to the analyst's home folder.

d. Open a terminal in Security Onion VM and create a SHA256 hash from the exported file. Use the
following command:

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/db0e84ab-31a2-4f02-8efc-0d39b83bf715)

e. Copy the file hash and submit it to the Cisco Talos file reputation center at
https://talosintelligence.com/talos_file_reputation.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/511c4fae-92ef-4180-bc0c-2dd27595d9e3)

Did Talos recognize the file hash and identif y it as malware? If so, what kind of malware?

f. In Sguil select the alert with Alert ID 5.480 and the Event Message Remcos RAT Checkin 23. Notice that the IDS signature has detected the Remcos RAT based on the binary hex codes at the beginning of communication.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/e2b8744a-b4b9-489e-a294-2d5e915abb63)

g. Right click the Alert ID and select Transcript. Scroll through the transcript and answer the following
questions:

What is the destination port of the communication? Is it a well-known port?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/ae5fd079-9768-45d6-af54-864df51c3a41)

- It is not a well-known port

Is the communication readable or is it encrypted?
- It is encrypted

Do some online research on Remcos RAT Checkin 23. What does Remcos stand for?
- Remote Control and Surveillance software

What type of communication do you think was being transmitted?
- A keylogger possibly sending keystroke information to a C2C server

What type of encryption and obfuscation was used to bypass detection?
- RC4 and base64 to obfuscate data.

h. Using Sguil and the remaining alerts from 3-19-2019, locate the second executable file that was
downloaded and check to see if it is known malware.


**NOT COMPLETED**
## Part 2: Use Kibana to Investigate Alerts
### Step 1: Open Kibana and narrow the timeframe.
a. Login to Kibana with the analyst username and cyberops password.

b. Open Kibana (username analyst and password cyberops), click Last 24 Hours and the Absolute time
range tab to change the time range to March 1, 2019 to March 31, 2019.

c. The Total Log Count Over Time timeline will show an event on March 19. Click that event to narrow the
focus to the specific time range of the attack.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/d450ab11-0dac-4ae4-8b4c-f52b9e107df9)

### Step 2: Review the alerts in the narrowed timeframe.
a. In the Kibana dashboard scroll down to the All Sensors - Log Type visualization. Review both pages
and note the variety of log types related to this attack.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/ea05ef3b-11d9-4653-8d5e-22fc1f5f28f5)

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/fe413ed9-e1ac-4905-8523-84300375d538)

b. Scroll down and notice that the NIDS Alert Summary in Kibana has many of the same IDS alerts as listed
in Sguil. Click the magnifier to filter on the second alert ET TROJAN ABUSE.CH SSL Blacklist Malicious
SSL certificate detected (Dridex) from Source IP Address 31.22.4.176.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/96098cac-9b57-4a49-9e0e-088771c8ae23)

c. Scroll down to All Logs and click the arrow to expand the first log in the list with source IP address
31.22.4.176.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/3294c5c7-b86a-4793-8bb0-81b66feed344)

What is the geo country and city location for this alert?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/87aa2cc4-915e-47f0-a5aa-ffccde38769d)

What is the geo country and city for the alert from 115.112.43.81?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/96c593fa-ac78-40a9-ae3c-1d75455bdaf9)

d. Scroll back to the top of the page and click the Home link under Navigation.

e. Earlier we noted log types like bro_http listed in the Home dashboard. You can filter for the various log
type but the built-in dashboards will probably have more information. Scroll back to the top of the page
and click HTTP in dashboard link under Zeek Hunting in Navigation.

f. Scroll through the HTTP dashboard taking notice of the information presented and answer the following
questions:

What is the Log Count in the HTTP dashboard? From what countries?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/84ec3377-4869-41ab-82a1-e61f9879939e)

- United States and Netherlands

What are the URIs for the files that were downloaded?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/1bd08db9-c7fc-462b-994a-a5d0a50a63c4)

g. Match the HTTP - URIs to the HTTP - Sites on the dashboard.

What are the CSPCA.crl and ncsi.txt files related to? Use a web browser and a search engine for
additional information.

h. Scroll back to the top of the web page and under Navigation – Zeek Hunting click DNS. Scroll to the DNS Queries visualization. Notice page 1 and page 3 of the DNS queries.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/211f5cac-3196-42d3-84e6-8f589a054418)

Do any of the domains seem potentially unsafe? Try submitting the URL toptoptop1.online to
virustotal.com. What is the result?
- 4 detection engines recognize the URL as malicious regarding malware

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/a1125241-63a2-46ec-9fa5-945f1bd1b876)

i. For further investigation and curiosity, try examining the following Zeek Hunting dashboards:

DCE/RPC - for information about the Windows network remote procedures and resources involved

Kerberos – for information on the hostnames, and domain names that were used

PE – for information on the portable executables

SSL and x.509 – for information on the security certificate names and countries that were used

SMB – for more information on the SMB shares on the littletigers network

Weird – for protocol and service anomalies and malformed communications
