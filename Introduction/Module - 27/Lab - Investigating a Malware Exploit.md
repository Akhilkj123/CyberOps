## Part 1: Use Kibana to Learn About a Malware Exploit
### Step 1: Narrow the timeframe.
a. Login to Security Onion with the analyst username and cyberops password.

b. Open Kibana (username analyst and password cyberops) and set an Absolute time range to narrow the
focus to log data from January 2017.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/d536b5c4-4290-4fbf-8798-4e5ad3f7130e)

c. You will see a graph appear with a single entry showing. To view more details, you need to narrow the
amount of time that is displayed. Narrow the time range in the Total Log Count Over Time visualization by clicking and dragging to select an area around the graph data point. You may need to repeat this process
until you see some detail in the graph.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/da11e06c-39f5-43ee-b56c-da8816a075ef)

### Step 2: Locate the Event in Kibana
a. After narrowing the time range in the main Kibana dashboard, go to the NIDS Alert Data dashboard by
clicking NIDS.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/e0819435-56c2-49af-8ad2-a446f6fd9f49)

b. Zoom in on the event by clicking and dragging in the NIDS – Alerts Over Time visualization further focus
in on the event timeframe. Since the event happened over a very short period of time, select just the
graph plot line. Zoom in until your display resembles the one below.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/3e8955ea-e6a9-4600-a048-26881dd3b3ef)

c. Click the first point on the timeline to filter for only that first event.

d. Now view details for the events that occurred at that time. Scroll all the way to the bottom of the
dashboard until you see the NIDS Alerts section of the page. The alerts are arranged by time. Expand
the first event in the list by clicking the pointer arrow that is to the left of the timestamp.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/e419f354-7896-4bb0-9bc4-ce42b44b3a31)

e. Look at the expanded alert details and answer the following questions:

What is the time of the first detected NIDS alert in Kibana?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/7933ac97-2725-46c2-9879-289c1c3f327d)

What is the source IP address in the alert?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/1f5332e1-5510-4df8-96d0-25814d5e36b3)

What is the destination IP address in the alert?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/6391309b-fd60-4723-bc49-ecd0a3ca6efc)

What is the destination port in the alert? What service is this?

- 80 : HTTP

What is the destination geo country name?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/87bf66a1-92f3-41dd-9f4c-9a88a66b6c28)

f. In a web browser on a computer that can connect to the internet, go to the link that is provided in the
signature_info field of the alert. This will take you to the Emerging Threats Snort alert rule for the exploit.
There are a series of rules shown. This is because signatures can change over time, or new and more
accurate rules are developed. The newest rule is at the top of the page. Examine details of the rule.

What is the malware family for this event?
- Exploit_Kit_RIG

What is the severity of the exploit?
- The signature severity is Major.

What is an Exploit Kit? (EK) Search on the internet to answer this question.
- An Exploit Kit is an exploit that uses multiple websites and redirects to infect a computer with malware.

### Step 3: View the Transcript capME!
a. Click the alert _id value, you can pivot to CapME to inspect the transcript of the event.

In the CapME! window you can see the transcript from the session. It shows the transactions between the
source computer, in blue, and the destinations that are accessed by the source. A lot of valuable
information, including a link to the pcap file that is related to this alert, is available in the transcript.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/7339ef6e-c8ae-4d35-a108-0098e795ac90)

Examine the first block of blue text. This is the request from the source to the destination webserver. Note
that two URLs are listed in this block. The first is tagged as SRC: REFERER. This is the website that the
source computer first accessed. However, the server referred browser the HTTP GET request to the
SRC:HOST. Something in the HTML sent the source to this site. It looks like this could be a drive-by
attack!

What website did the user intend to connect to?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/2818cc92-f7d3-4f5a-8083-80f24cfc9a9e)

What URL did the browser refer the user to?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/27fc6751-32f0-482a-a406-dc1800887a7d)

What kind of content is requested by the source host from tybenme.com? Why could this be a problem? Look in the DST server block of the transcript too.
- The content is shown as gzip. This could be a malware file that has been requested for download. It is probably a malware file. Because it is compressed, the contents of the file are obfuscated. It is not easy to see what is in the file.

b. Close the CapME! browser tab.

c. From the top of the NIDS Alert Dashboard click the HTTP entry located under Zeek Hunting

d. In the HTTP dashboard, verify that your absolute time range includes 2017-01-27 22:54:30.000 to 2017-01-27 22:56:00.000.


Scroll down to the HTTP – Sites section of the dashboard.

## Part 2: Investigate the Exploit with Sguil
### Step 1: Open Sguil and locate the alerts.
a. Launch Sguil from the desktop. Login with username analyst and password cyberops. Enable all
sensors and click Start.

b. Locate the group of alerts from January 27th 2017.

According to Sguil, what are the timestamps for the first and last of the alerts that occurred within about a
second of each other?

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/83e8b105-97ea-4e60-b3f3-49f823b6b87e)

### Step 2: Investigate the alerts in Sguil.
a. Click the Show Packet Data and Show Rule checkboxes to see the packet header field information and
the IDS signature rule related to the alert.

b. Select the alert ID 5.2 (Event message ET CURRENT Evil Redirector Leading to EK Jul 12 2016).

According to the IDS signature rule which malware family triggered this alert? You may need to scroll
through the alert signature to find this entry.

![image](https://github.com/Akhilkj123/CyberOps/assets/65653010/a5d0fe83-aba4-4725-bcd3-182e8aa20965)

c. Maximize the Sguil window and size the Event Message column so that you can see the text of the entire
message. Look at the Event Messages for each of the alert IDs related to this attack.

According to the Event Messages in Sguil what exploit kit (EK) is involved in this attack?
